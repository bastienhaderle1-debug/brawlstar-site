<!--pages/profile.html-->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profil</title>
  <link rel="stylesheet" href="../style.css" />
</head>

<body>
  <header class="header container">
    <div class="headerbar">
      <div>
        <h1 data-title="PROFIL">üë§ PROFIL</h1>
        <p class="muted">Recherche un joueur par pseudo, ou ouvre un profil via ?u=UUID.</p>

        <nav class="nav">
          <a href="../index.html">Accueil</a>
          <a href="./mybrawl.html">MyBrawl</a>
          <a href="./profile.html">Profil</a>
          <a href="./brawlers.html">Brawlers</a>
          <a href="./skins.html">Skins</a>
        </nav>
      </div>

      <div class="header-right">
        <div class="badge ko" id="globalAuthBadge">
          <span class="dot"></span>
          <span>Non connect√©</span>
        </div>

        <a class="seg-btn" href="./mybrawl.html">üë§ Mon compte</a>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Recherche pseudo -->
    <section class="card">
      <h2 data-title="RECHERCHE">üîé RECHERCHE</h2>
      <p class="muted">Tape un pseudo (public) et s√©lectionne un r√©sultat.</p>

      <section class="toolbar" style="margin-bottom:10px;">
        <div class="filter" style="min-width:260px; flex:1;">
          <label for="searchName">Pseudo</label>
          <input id="searchName" class="input" type="text" placeholder="ex: BabaXkiwi" />
        </div>

        <div style="display:flex; align-items:end; gap:10px; flex-wrap:wrap;">
          <button class="seg-btn is-active" id="btnSearch" type="button">Rechercher</button>
          <button class="seg-btn" id="btnClear" type="button">Effacer</button>
        </div>
      </section>

      <p class="muted" id="searchMsg"></p>

      <div class="cards" id="searchResults" style="grid-template-columns: repeat(2, minmax(240px, 1fr));"></div>
    </section>

    <!-- Erreur -->
    <section class="card" id="errorCard" style="display:none; margin-top:14px;">
      <h2 data-title="ERREUR">‚ùå ERREUR</h2>
      <p class="muted" id="errorMsg"></p>
      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
        <a class="seg-btn" href="../index.html">‚¨Ö Retour accueil</a>
        <a class="seg-btn" href="./mybrawl.html">üë§ Aller sur MyBrawl</a>
      </div>
    </section>

    <!-- Profil -->
    <section class="card" id="profileCard" style="display:none; margin-top:14px;">
      <h2 id="displayName">‚Äî</h2>
      <p class="muted" id="bio">‚Äî</p>
      <p class="muted" id="updatedLine"></p>
      <p class="muted" id="shareLine"></p>

      <div class="stats-grid">
        <div class="stat">
          <div class="stat-label">Skins poss√©d√©s (public)</div>
          <div class="stat-value" id="statOwned">0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Total skins (base)</div>
          <div class="stat-value" id="statTotal">0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Progression</div>
          <div class="stat-value" id="statPct">0%</div>
        </div>
      </div>

      <div class="progress"><div class="progress-bar" id="progressBar" style="width:0%"></div></div>
      <p class="muted" id="publicModeLine" style="margin-top:12px;"></p>

      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
        <button class="seg-btn" id="btnCopyLink" type="button">üîó Copier le lien</button>
      </div>
    </section>

    <!-- Filtres skins -->
    <section class="toolbar" id="toolbar" style="display:none; margin-top:14px;">
      <div class="filter">
        <label for="searchSkins">Recherche skins</label>
        <input id="searchSkins" class="input" type="text" placeholder="ex: shelly, star..." />
      </div>

      <div class="filter">
        <label for="filterRarity">Raret√©</label>
        <select id="filterRarity" class="select"></select>
      </div>
    </section>

    <!-- Liste skins -->
    <section id="skinsSection" style="display:none; margin-top:8px;">
      <h2 data-title="SKINS">‚úÖ SKINS</h2>
      <p class="muted" id="resultCount"></p>
      <div class="cards" id="cards"></div>
    </section>
  </main>

  <footer class="footer container">
    <a href="../index.html">‚¨Ö Retour √† l‚Äôaccueil</a>
  </footer>

  <script src="../js/toast.js"></script>
  <script src="../js/guard.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../data/supabase-client.js"></script>
  <script src="../data/skins-data.js"></script>

  <script src="../js/owned-service.js"></script>
  <script src="../js/profile.js"></script>
  <script src="../js/site.js"></script>
</body>
</html>
